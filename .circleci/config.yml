version: 2.1

executors:
  java-executor:
    docker:
      - image: circleci/openjdk:8-jdk  # Utilisation de l'image Docker avec Java 8 JDK

jobs:
  build:
    executor: java-executor  # Utilisation de l'exécuteur défini ci-dessus
    steps:
      - checkout  # Vérifier le code source
      - run:
          name: Install Maven
          command: |
            curl -s https://archive.apache.org/dist/maven/binaries/apache-maven-3.8.4-bin.tar.gz | tar xz
            echo 'export PATH=$PATH:$(pwd)/apache-maven-3.8.4/bin' >> $BASH_ENV
            source $BASH_ENV
      - run:
          name: Run Maven tests
          command: mvn test  # Exécuter les tests unitaires avec Maven

workflows:
  version: 2
  build:
    jobs:
      - build:
          filters:
            branches:
              only:
                - master  # Exécuter uniquement sur la branche master
